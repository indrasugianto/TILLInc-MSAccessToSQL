-- Query Name: qryPeopleResidentialClientsReportExport
-- Extracted: 2026-02-04 13:04:22

SELECT tblPeople.IndexedName AS ClientIndexedName, tblPeople.LastName AS ClientLastName, tblPeople.FirstName AS ClientFirstName, tblPeopleClientsDemographics.SocialSecurityNumber AS ClientSSN, tblPeopleClientsDemographics.LegalStatus AS ClientLegalStatus, tblPeopleClientsDemographics.DateOfBirth AS ClientDOB, IIf([tblPeople]![IsClientRes],'RES',IIf([tblPeople]![IsCilentCLO],'CLO',IIf([tblPeople]![IsClientSharedLiving],'SL',''))) AS ClientService, IIf([tblPeopleClientsDemographics]![ActiveResidentialServices],[tblPeopleClientsResidentialServices]![CityTown] & '-' & [tblPeopleClientsResidentialServices]![Location],IIf([tblPeopleClientsDemographics]![ActiveCLO],[tblPeopleClientsCLOServices]![CityTown] & '-' & [tblPeopleClientsCLOServices]![Location],IIf([tblPeopleClientsDemographics]![ActiveSharedLiving],'Shared Living',''))) AS ClientProgram, IIf([tblPeopleClientsDemographics]![ActiveResidentialServices],[tblPeopleClientsResidentialServices]![StartDate],IIf([tblPeopleClientsDemographics]![ActiveSharedLiving],[tblPeopleClientsSharedLivingServices]![StartDate],IIf([tblPeopleClientsDemographics]![ActiveCLO],[tblPeopleClientsCLOServices]![StartDate],Null))) AS ClientStartDate, IIf([tblPeopleClientsDemographics]![ActiveResidentialServices],[tblPeopleClientsResidentialServices]![Funding],IIf([tblPeopleClientsDemographics]![ActiveSharedLiving],Null,IIf([tblPeopleClientsDemographics]![ActiveCLO],[tblPeopleClientsCLOServices]![Funding],Null))) AS ClientFundingSource INTO temptbl1
FROM (((tblPeople INNER JOIN tblPeopleClientsDemographics ON tblPeople.IndexedName = tblPeopleClientsDemographics.IndexedName) LEFT JOIN tblPeopleClientsResidentialServices ON tblPeopleClientsDemographics.IndexedName = tblPeopleClientsResidentialServices.IndexedName) LEFT JOIN tblPeopleClientsCLOServices ON tblPeopleClientsDemographics.IndexedName = tblPeopleClientsCLOServices.IndexedName) LEFT JOIN tblPeopleClientsSharedLivingServices ON tblPeopleClientsDemographics.IndexedName = tblPeopleClientsSharedLivingServices.IndexedName
WHERE (((tblPeople.IsClientRes)=True) AND ((tblPeopleClientsResidentialServices.Inactive)=False) AND ((tblPeople.IsDeceased)=False)) OR (((tblPeople.IsDeceased)=False) AND ((tblPeople.IsCilentCLO)=True) AND ((tblPeopleClientsCLOServices.Inactive)=False)) OR (((tblPeople.IsDeceased)=False) AND ((tblPeople.IsClientSharedLiving)=True) AND ((tblPeopleClientsSharedLivingServices.Inactive)=False))
ORDER BY tblPeople.IndexedName;


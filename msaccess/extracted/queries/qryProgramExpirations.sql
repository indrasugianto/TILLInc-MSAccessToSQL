-- Query Name: qryProgramExpirations
-- Extracted: 2026-01-29 16:09:05

SELECT tblLocations.CityTown, tblLocations.LocationName, tblLocations.Department, IIf(IsNumeric([Cluster]),Val([Cluster]),Null) AS ResCluster, IIf(IsDate([tblLocations].[HouseSafetyPlanExpires]),DateValue([tblLocations].[HouseSafetyPlanExpires]),Null) AS HouseSafetyPlanExpires, IIf(IsDate([tblLocations].[HousePlansReviewedByStaffBefore]),DateValue([tblLocations].[HousePlansReviewedByStaffBefore]),Null) AS HousePlansReviewedByStaffBefore, StrConv([tblLocations].[HumanRightsOfficer],3) AS HRO, IIf(IsDate([tblLocations].[HROTrainsStaffBefore]),DateValue([tblLocations].[HROTrainsStaffBefore]),Null) AS HROTrainsStaffBefore, IIf(IsDate([tblLocations].[HROTrainsIndividualsBefore]),DateValue([tblLocations].[HROTrainsIndividualsBefore]),Null) AS HROTrainsIndividualsBefore, StrConv(tblLocations.FireSafetyOfficer,3) AS FSO, IIf(IsDate(([tblLocations].[FSOTrainsStaffBefore])),DateValue([tblLocations].[FSOTrainsStaffBefore]),Null) AS FSOTrainsStaffBefore, IIf(IsDate([tblLocations].[FSOTrainsIndividualsBefore]),DateValue([tblLocations].[FSOTrainsIndividualsBefore]),Null) AS FSOTrainsIndividualsBefore, IIf(IsDate([tblLocations].[LastVehicleChecklistCompleted]),DateValue([tblLocations].[LastVehicleChecklistCompleted]),Null) AS LastVehicleChecklistCompleted, IIf(IsDate([tblLocations].[MAPChecklistCompleted]),DateValue([tblLocations].[MAPChecklistCompleted]),Null) AS MAPChecklistCompleted INTO temptbl
FROM tblLocations
WHERE (((tblLocations.Department)="Day Services" Or (tblLocations.Department)="Residential Services")) OR (((tblLocations.CityTown)<>"Dedham") AND ((tblLocations.Department)="Vocational Services")) OR (((tblLocations.CityTown)<>"Dedham") AND ((tblLocations.Department)="Individualized Support Options"))
ORDER BY tblLocations.CityTown, tblLocations.LocationName;


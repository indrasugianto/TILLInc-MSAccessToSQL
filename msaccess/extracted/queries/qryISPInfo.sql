-- Query Name: qryISPInfo
-- Extracted: 2026-02-04 13:04:22

SELECT tblPeople.LastName, tblPeople.FirstName, tblPeople.PhysicalAddress, tblPeople.PhysicalCity, tblPeople.PhysicalState, tblPeople.PhysicalZIP, tblPeople.CLOLocation, tblPeople.DayLocation, tblPeople.ResLocation, IIf([tblPeople]![IsClientRes],Val(DLookUp("Cluster","tblLocations","CityTown='" & [tblPeopleClientsResidentialServices]![CityTown] & "' AND LocationName='" & [tblPeopleClientsResidentialServices]![Location] & "'")),Null) AS ResCluster, tblLocations.CommmunityRNName, IIf(IsDate([DateISP]),DateValue([DateISP]),Null) AS ISP, IIf(IsDate([DateBMMExpires]),DateValue([DateBMMExpires]),Null) AS MTPExpires, IIf(IsDate([DateSPDAuthExpires]),DateValue([DateSPDAuthExpires]),Null) AS SPDAuthExpires, IIf(IsDate([DateSPDSignedHRC]),DateValue([DateSPDSignedHRC]),Null) AS SPDSignedHRC, IIf(IsDate([DateSPDSigned]),DateValue([DateSPDSigned]),Null) AS SPDSigned, IIf(IsDate([DateISP]),DateAdd("d",-45,DateValue([DateISP])),Null) AS [Review and Sign Off HCR Done By], IIf(IsDate([DateISP]),DateAdd("d",-30,DateValue([DateISP])),Null) AS [First Date HCR Can Be Finalized On], IIf(IsDate([DateISP]),DateAdd("d",-23,DateValue([DateISP])),Null) AS [Final Date HCR Must Be Finalized By] INTO temptbl
FROM ((((tblPeople LEFT JOIN tblPeopleClientsDemographics ON tblPeople.IndexedName = tblPeopleClientsDemographics.IndexedName) LEFT JOIN tblPeopleClientsCLOServices ON tblPeople.IndexedName = tblPeopleClientsCLOServices.IndexedName) LEFT JOIN tblPeopleClientsDayServices ON tblPeople.IndexedName = tblPeopleClientsDayServices.IndexedName) LEFT JOIN tblPeopleClientsResidentialServices ON tblPeople.IndexedName = tblPeopleClientsResidentialServices.IndexedName) LEFT JOIN tblLocations ON (tblPeopleClientsResidentialServices.Location = tblLocations.LocationName) AND (tblPeopleClientsResidentialServices.CityTown = tblLocations.CityTown)
WHERE (((tblPeople.IsDeceased)=False) AND ((tblPeople.IsClientDay)=True) AND ((tblPeopleClientsDayServices.Inactive)=False)) OR (((tblPeople.IsDeceased)=False) AND ((tblPeople.IsClientRes)=True) AND ((tblPeopleClientsResidentialServices.Inactive)=False)) OR (((tblPeople.IsDeceased)=False) AND ((tblPeople.IsCilentCLO)=True) AND ((tblPeopleClientsCLOServices.Inactive)=False))
ORDER BY IIf([IsClientDay],"Day",IIf([IsClientRes],"Res","CLO")), tblPeople.CLOLocation, tblPeople.DayLocation, tblPeople.ResLocation, tblPeople.LastName, tblPeople.FirstName;

